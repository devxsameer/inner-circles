{{!-- ================================
CIRCLE HEADER
================================ --}}
<section class="py-8">
  <div class="wrapper">

    {{#with circle}}

    <h1 class="text-3xl font-bold text-rose-600 mb-1">{{name}}</h1>

    <p class="text-gray-600 mb-4">
      {{#if description}}{{description}}{{else}}<em>No description provided.</em>{{/if}}
    </p>

    {{!-- ============================
    1. OWNER VIEW
    ============================= --}}
    {{#ifEqual ../role "owner"}}
    <span class="inline-block px-3 py-1 text-xs font-semibold bg-green-100 text-green-700 rounded-full">
      You Own This Circle
    </span>

    <div class="mt-3 flex justify-end">
      <a href="/circles/{{id}}/delete"
         class="btn bg-rose-600">
        Delete This Circle
      </a>
    </div>

    <hr class="my-4">
    {{> membersList members=../members }}



    {{!-- ============================
    2. ADMIN VIEW
    ============================= --}}
    {{else ifEqual ../role "admin"}}
    <span class="inline-block px-3 py-1 text-xs font-semibold bg-blue-100 text-blue-700 rounded-full">
      You are Admin of This Circle
    </span>

    <p class="text-gray-600 mt-2 text-sm">
      You help manage this circle. Contact the owner for full privileges.
    </p>

    <hr class="my-4">
    {{> membersList members=../members }}



    {{!-- ============================
    3. MEMBER VIEW
    ============================= --}}
    {{else ifEqual ../role "member"}}

    <span class="inline-block px-3 py-1 text-xs font-semibold bg-gray-100 text-gray-700 rounded-full">
      You are a Member
    </span>

    <p class="text-gray-600 mt-2 text-sm">
      Enjoy posts and discussions with others!
    </p>

    <hr class="my-4">
    {{> membersList members=../members }}



    {{!-- ============================
    4. NON-MEMBER (LOGGED-IN)
    ============================= --}}
    {{else if ../user}}

    <span class="inline-block px-3 py-1 text-xs font-semibold bg-red-100 text-red-700 rounded-full">
      You are not a member of this circle
    </span>

    <p class="text-gray-600 mt-3">
      Join this circle to access member-only posts and discussions.
    </p>

    <a href="/circles/{{id}}/join"
       class="btn inline-block mt-2 transition">
      Join Circle
    </a>

    <hr class="my-4 text-gray-400">

    <p class="text-gray-700 text-sm">
      <span class="font-semibold">Owner:</span> {{ownerUsername}}
    </p>


    {{!-- ============================
    5. NOT LOGGED IN (guest)
    ============================= --}}
    {{else}}

    <span class="inline-block px-3 py-1 text-xs font-semibold bg-gray-100 text-gray-600 rounded-lg">
      You must log in to join the circle and view member-only posts.
    </span>

    <div class="mt-3 flex gap-3">
      <a href="/auth/login"
         class="btn">Login</a>

      <a href="/auth/signup"
         class="btn bg-neutral-50 text-neutral-950 hover:bg-neutral-100">Signup</a>
    </div>

    <hr class="my-4 text-gray-400">

    <p class="text-gray-700 text-sm">
      <span class="font-semibold">Owner:</span> {{ownerUsername}}
    </p>

    {{/ifEqual}}

    {{/with}}

  </div>
</section>


{{!-- ================================
POSTS SECTION
================================ --}}
<section class="bg-gray-50 border-neutral-200 border-t border-b py-8">
  <div class="wrapper">


    <h2 class="text-2xl font-semibold mb-4">Posts</h2>

    {{#if circlePosts}}

    <div class="grid md:grid-cols-2 gap-4">
      {{#each circlePosts}}
      {{#> postCard hideCircle=true role=../role}}
      {{/postCard}}
      {{/each}}
    </div>

    {{> pagination}}

    {{else}}
    <p class="text-gray-500">This circle has no posts yet.</p>
    {{/if}}

  </div>
</section>